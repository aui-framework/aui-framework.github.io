<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" class="dark-mode">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AUI Framework: Writing tests</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_doxygen.svg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AUI Framework
   &#160;<span id="projectnumber">develop</span>
   </div>
   <div id="projectbrief">Cross-platform module-based framework for developing  C++20 desktop applications</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_docs_Writing_tests.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Writing tests </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p >AUI uses GTest as the tests framework and provides a simple way to use it in your application.</p>
<p >It also includes GMock library.</p>
<p >GoogleTest is Google's C++ testing and mocking framework. This user's guide has the following contents:</p>
<ul>
<li><a href="https://github.com/google/googletest/blob/main/docs/primer.md">GoogleTest Primer</a> - Teaches you how to write simple tests using GoogleTest. Read this first if you are new to GoogleTest.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/advanced.md">GoogleTest Advanced</a> - Read this when you've finished the Primer and want to utilize GoogleTest to its full potential.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/samples.md">GoogleTest Samples</a> - Describes some GoogleTest samples.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/faq.md">GoogleTest FAQ</a> - Have a question? Want some tips? Check here first.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/gmock_for_dummies.md">Mocking for Dummies</a> - Teaches you how to create mock objects and use them in tests.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/gmock_cook_book.md">Mocking Cookbook</a> - Includes tips and approaches to common mocking use cases.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/gmock_cheat_sheet.md">Mocking Cheat Sheet</a> - A handy reference for matchers, actions, invariants, and more.</li>
<li><a href="https://github.com/google/googletest/blob/main/docs/gmock_faq.md">Mocking FAQ</a> - Contains answers to some mocking-specific questions.</li>
</ul>
<h2><a class="anchor" id="autotoc_md135"></a>
In AUI</h2>
<p >In order to enable tests for your project, call <code>aui_enable_tests(&lt;target-name&gt;)</code> in the end of your <code>CMakeLists.txt</code> and create <code>tests/</code> dir along with <code>src/</code> and <code>CMakeLists.txt</code>. Place your test suites inside the <code>tests/</code> directory.</p>
<h1><a class="anchor" id="autotoc_md136"></a>
Example</h1>
<p >Suppose we want to test the <code>sum</code> function of the following program:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;AUI/Platform/Entry.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;AUI/Logging/ALogger.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;main.h&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keyword">auto</span> LOG_TAG = <span class="stringliteral">&quot;MyApp&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> sum(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b) {</div>
<div class="line">  <span class="keywordflow">return</span> a + b;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="group__useful__macros.html#ga9fb2be9313369673815a6892aa7f3a1f">AUI_ENTRY</a> {</div>
<div class="line">    ALogger::info(LOG_TAG) &lt;&lt; <span class="stringliteral">&quot;2 + 2 = &quot;</span> &lt;&lt; sum(2, 2);</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="agroup__useful__macros_html_ga9fb2be9313369673815a6892aa7f3a1f"><div class="ttname"><a href="group__useful__macros.html#ga9fb2be9313369673815a6892aa7f3a1f">AUI_ENTRY</a></div><div class="ttdeci">#define AUI_ENTRY</div><div class="ttdoc">Application entry point.</div><div class="ttdef"><b>Definition:</b> Entry.h:92</div></div>
</div><!-- fragment --><p >Possible output:</p>
<div class="fragment"><div class="line">[14:57:02][UI Thread][MyApp][INFO]: 2 + 2 = 4</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md137"></a>
Project structure</h2>
<p >To write a test, enable tests for your projects first. Add <code>aui_enable_tests(&lt;target-name&gt;)</code> to the end of your <code>CMakeLists.txt</code>:</p>
<div class="fragment"><div class="line"># Standard routine</div>
<div class="line">cmake_minimum_required(VERSION 3.16)</div>
<div class="line">project(project_template)</div>
<div class="line"> </div>
<div class="line"># Use AUI.Boot</div>
<div class="line">file(</div>
<div class="line">    DOWNLOAD </div>
<div class="line">    https://raw.githubusercontent.com/aui-framework/aui/master/aui.boot.cmake </div>
<div class="line">    ${CMAKE_CURRENT_BINARY_DIR}/aui.boot.cmake)</div>
<div class="line">include(${CMAKE_CURRENT_BINARY_DIR}/aui.boot.cmake)</div>
<div class="line"> </div>
<div class="line"># link AUI</div>
<div class="line">auib_import(</div>
<div class="line">    AUI https://github.com/aui-framework/aui </div>
<div class="line">    COMPONENTS core)</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Create the executable. This function automatically links all sources from the src/ folder, creates CMake target and</div>
<div class="line"># places the resulting executable to bin/ folder.</div>
<div class="line">aui_executable(project_template)</div>
<div class="line"> </div>
<div class="line"># Link required libs</div>
<div class="line">target_link_libraries(project_template PRIVATE aui::core)</div>
<div class="line"> </div>
<div class="line">aui_enable_tests(project_template) # &lt;----------------------------------------------</div>
</div><!-- fragment --><p >and create the <code>tests/</code> dir along with <code>CMakeLists.txt</code> and <code>src/</code>. Inside <code>tests/</code>, create <code>MyTest.cpp</code>:</p>
<div class="fragment"><div class="line">CMakeLists.txt</div>
<div class="line">src</div>
<div class="line">├── main.cpp</div>
<div class="line">└── main.h</div>
<div class="line">tests</div>
<div class="line">└── MyTest.cpp</div>
</div><!-- fragment --><p >Note the <code>main.h</code> file. Since we would like to access the <code>sum</code> function of <code>main.cpp</code>, we should put <code>sum</code> declaration to the <code>main.h</code> file:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#pragma once</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> sum(<span class="keywordtype">int</span> a, <span class="keywordtype">int</span> b);</div>
</div><!-- fragment --><p >Put the basic test case to <code>MyTest.cpp</code>:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;gtest/gtest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;main.h&quot;</span></div>
<div class="line"> </div>
<div class="line">TEST(MyTest, Sum) {</div>
<div class="line">  ASSERT_EQ(sum(2, 2), 4);</div>
<div class="line">}</div>
</div><!-- fragment --><p >Build <code>Tests</code> and run <code>bin/Tests</code>. Possible output:</p>
<div class="fragment"><div class="line">[==========] Running 1 test from 1 test suite.</div>
<div class="line">[----------] Global test environment set-up.</div>
<div class="line">[----------] 1 test from MyTest</div>
<div class="line">[ RUN      ] MyTest.Sum</div>
<div class="line">[       OK ] MyTest.Sum (0 ms)</div>
<div class="line">[----------] 1 test from MyTest (0 ms total)</div>
<div class="line"> </div>
<div class="line">[----------] Global test environment tear-down</div>
<div class="line">[==========] 1 test from 1 test suite ran. (0 ms total)</div>
<div class="line">[  PASSED  ] 1 test.</div>
</div><!-- fragment --><p >AUI does the following fundamental things for you:</p>
<ol type="1">
<li>Collect all tests from your <code>tests/</code> dir</li>
<li>Provide an entry point for the <code>Tests</code> program (testing::InitGoogleTest)</li>
<li>Mirror all linked libraries and compile options to the <code>Tests</code> program</li>
<li>If you are testing a shared library, the shared library is linked to the <code>Tests</code> program</li>
<li>If you are testing an executable, the executable's sources are automatically compiled with the <code>Tests</code> program and the <code>include</code> scope of the executable is copied to the <code>Tests</code> program (this is why we have easily accessed the <code>main.h</code> header)</li>
</ol>
<h1><a class="anchor" id="autotoc_md140"></a>
Writing UI Tests</h1>
<p >Since AUI is a UI framework it is also capable of UI tests.</p>
<p >In addition to the previous example, we'd create some window:</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;AUI/UITest.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;AUI/Util/UIBuildingHelpers.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;AUI/View/AButton.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;AUI/Platform/AWindow.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;AUI/View/ATextField.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;AUI/View/AScrollArea.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;gmock/gmock.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>TestWindow: <span class="keyword">public</span> <a class="code hl_class" href="classAWindow.html">AWindow</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    TestWindow() {</div>
<div class="line">        <a class="code hl_function" href="classAViewContainer.html#ab7bcd4a4bc08fc11c9bc1a9ff036f5e4">setContents</a>(<a class="code hl_struct" href="structaui_1_1ui__building_1_1layouted__container__factory.html">Centered</a> {</div>
<div class="line">            _new&lt;AButton&gt;(<span class="stringliteral">&quot;Hello!&quot;</span>)</div>
<div class="line">        });</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span><a class="code hl_class" href="classUIScrollTest.html">UIScrollTest</a>: <span class="keyword">public</span> <a class="code hl_class" href="classtesting_1_1UITest.html">testing::UITest</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">class </span>TestWindow: <span class="keyword">public</span> <a class="code hl_class" href="classAWindow.html">AWindow</a> {</div>
<div class="line">    <span class="keyword">public</span>:</div>
<div class="line">        TestWindow(): <a class="code hl_class" href="classAWindow.html">AWindow</a>(<span class="stringliteral">&quot;Test window&quot;</span>, 200_dp, 100_dp) {</div>
<div class="line">            <a class="code hl_function" href="classAViewContainer.html#ab7bcd4a4bc08fc11c9bc1a9ff036f5e4">setContents</a>(<a class="code hl_struct" href="structaui_1_1ui__building_1_1layouted__container__factory.html">Vertical</a> {</div>
<div class="line">                    <a class="code hl_class" href="classAScrollArea_1_1Builder.html">AScrollArea::Builder</a>().withContents(_new&lt;MockedViewContainer&gt;()).withExpanding().build()</div>
<div class="line">            });</div>
<div class="line">        }</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_class" href="class__.html">_&lt;TestWindow&gt;</a> mTestWindow;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> SetUp()<span class="keyword"> override </span>{</div>
<div class="line">        UITest::SetUp();</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// prepare the window</span></div>
<div class="line">        mTestWindow = _new&lt;TestWindow&gt;();</div>
<div class="line">        mTestWindow-&gt;show();</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassAScrollArea_1_1Builder_html"><div class="ttname"><a href="classAScrollArea_1_1Builder.html">AScrollArea::Builder</a></div><div class="ttdef"><b>Definition:</b> AScrollArea.h:130</div></div>
<div class="ttc" id="aclassAViewContainer_html_ab7bcd4a4bc08fc11c9bc1a9ff036f5e4"><div class="ttname"><a href="classAViewContainer.html#ab7bcd4a4bc08fc11c9bc1a9ff036f5e4">AViewContainer::setContents</a></div><div class="ttdeci">void setContents(const _&lt; AViewContainer &gt; &amp;container)</div><div class="ttdoc">Moves (like via std::move) all children and layout of the specified container to this container.</div><div class="ttdef"><b>Definition:</b> AViewContainerBase.cpp:507</div></div>
<div class="ttc" id="aclassAWindow_html"><div class="ttname"><a href="classAWindow.html">AWindow</a></div><div class="ttdoc">Represents a window in the underlying windowing system.</div><div class="ttdef"><b>Definition:</b> AWindow.h:45</div></div>
<div class="ttc" id="aclassUIScrollTest_html"><div class="ttname"><a href="classUIScrollTest.html">UIScrollTest</a></div><div class="ttdef"><b>Definition:</b> UIScrollTest.cpp:44</div></div>
<div class="ttc" id="aclass___html"><div class="ttname"><a href="class__.html">_</a></div><div class="ttdoc">An std::weak_ptr with AUI extensions.</div><div class="ttdef"><b>Definition:</b> SharedPtrTypes.h:177</div></div>
<div class="ttc" id="aclasstesting_1_1UITest_html"><div class="ttname"><a href="classtesting_1_1UITest.html">testing::UITest</a></div><div class="ttdef"><b>Definition:</b> UITestCase.h:26</div></div>
<div class="ttc" id="astructaui_1_1ui__building_1_1layouted__container__factory_html"><div class="ttname"><a href="structaui_1_1ui__building_1_1layouted__container__factory.html">aui::ui_building::layouted_container_factory</a></div><div class="ttdef"><b>Definition:</b> Declarative.h:173</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
</body>
</html>
