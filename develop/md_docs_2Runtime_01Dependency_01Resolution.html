<!-- HTML header for doxygen 1.9.1--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class="dark-mode" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>
<meta content="Doxygen 1.13.1" name="generator"/>
<meta content="width=device-width, initial-scale=0.8" name="viewport"/>
<title>AUI Framework: Runtime Dependency Resolution</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"/>
<script src="jquery.js" type="text/javascript"></script>
<script src="dynsections.js" type="text/javascript"></script>
<script src="toc.js" type="text/javascript"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script src="navtreedata.js" type="text/javascript"></script>
<script src="navtree.js" type="text/javascript"></script>
<script src="resize.js" type="text/javascript"></script>
<script src="cookie.js" type="text/javascript"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script src="search/searchdata.js" type="text/javascript"></script>
<script src="search/search.js" type="text/javascript"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellpadding="0" cellspacing="0">
<tbody>
<tr style="height: 56px;">
<td id="projectlogo"><img alt="Logo" src="logo_doxygen.svg"/></td>
<td id="projectalign" style="padding-left: 0.5em;">
<div id="projectname">AUI Framework
                         <span id="projectnumber">develop</span>
</div>
<div id="projectbrief">Cross-platform base for C++ UI apps</div>
</td>
</tr>
</tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script src="menudata.js" type="text/javascript"></script>
<script src="menu.js" type="text/javascript"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('md_docs_2Runtime_01Dependency_01Resolution.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>
<div><div class="header">
<div class="headertitle"><div class="title">Runtime Dependency Resolution</div></div>
</div><!--header-->
<div class="contents aui-toc-contents"><div class="contents-rails-left"><b aui-src="docs/Runtime%20Dependency%20Resolution.md"></b>
<div class="textblock"><p>Runtime dependencies are files that are required by your application during execution. Typically, those files are program modules such as <code>*.dll</code>, <code>*.so</code> or <code>*.dylib</code>.</p>
<dl class="section note"><dt>Note</dt><dd>Runtime dependencies are not easy to deploy and might require additional building process tinkering. For icons, images, sounds and other resources consider using AUI assets to embed them right into your binary.</dd></dl>
<h1>
Build-time shared library resolution<a class="aui-toc-hash" href="#build-time-shared-library-resolution" id="build-time-shared-library-resolution" style="color: var(--fragment-comment) !important">#</a></h1>
<p>This section describes how runtime dependencies are resolved during build time (and development).</p>
<div class="fragment"><div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/api-ms-win-crt-convert-l1-1-0.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/api-ms-win-crt-environment-l1-1-0.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/aui.core.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/aui.views.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/freetype.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/libcurl.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/libsharpyuv.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/libssl.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">-- [AUI.BOOT/Runtime Dependency] D:/aui/bin/zlib1.dll -&gt; D:/a/aui/aui/build/bin</div>
<div class="line">...</div>
</div><!-- fragment --><h2>
DLL platforms (Windows only)<a class="aui-toc-hash" href="#dll-platforms-(windows-only)" id="dll-platforms-(windows-only)" style="color: var(--fragment-comment) !important">#</a></h2>
<p>Windows runtime linking process is simple. The dll lookup is performed as follows (ordered by priority):</p><ol type="1">
<li>Find dll in the same directory as exe or dll itself.</li>
<li>If <em>1.</em> is failed, find dll in <code>PATH</code> environment variable.</li>
<li>If both <em>1.</em> and <em>2.</em> are failed, show an error message box. (A helpful message indicating that some specific dll was not found is actually a rare case, Windows often displays an error with confusing text such as "error code 0xc000007b").</li>
</ol>
<p>On DLL targets, the first way is used: the runtime part of shared libraries (dll) are copied to <code>${CMAKE_BUILD_DIR}/bin</code> directory alongside exe files by <a class="el" href="md_docs_2AUI_01Boot.html">AUI Boot</a>. </p><div class="fragment"><div class="line">tree build/</div>
<div class="line">bin/aui_app.exe</div>
<div class="line">bin/aui.core.dll</div>
<div class="line">bin/aui.views.dll</div>
<div class="line">...</div>
</div><!-- fragment --><h2>
Other platforms (UNIX-like only)<a class="aui-toc-hash" href="#RPATH" id="RPATH" style="color: var(--fragment-comment) !important">#</a></h2>
<p>On UNIX-like platforms, a special directory hierarchy should be maintained, for both build tree and portable installations (for compatibility reasons), hence <a class="el" href="md_docs_2AUI_01Boot.html">AUI Boot</a> copies imported shared objects to <code>${CMAKE_BUILD_DIR}/lib</code>.</p>
<p>These libraries are picked up by targets defined via <a class="el" href="md_docs_2aui__module.html">aui_module</a> and <a class="el" href="md_docs_2aui__executable.html">aui_executable</a> by adjusting <code>RUNPATH</code>/<code>RPATH</code> which is a special field inside executables indicating where to find required shared libraries.</p>
<div class="fragment"><div class="line">function(_auib_apply_rpath AUI_MODULE_NAME)</div>
<div class="line">    if (BUILD_SHARED_LIBS AND AUI_PLATFORM_LINUX)</div>
<div class="line">        set(_rpath "$ORIGIN;$ORIGIN/../lib")</div>
<div class="line">        set_target_properties(${AUI_MODULE_NAME} PROPERTIES BUILD_RPATH "${_rpath}"</div>
<div class="line">                INSTALL_RPATH "${_rpath}")</div>
<div class="line">    endif()</div>
<div class="line">endfunction()</div>
</div><!-- fragment --><p>Additionally, RPATH is populated by compiler with hardcoded absolute paths to the dependencies hence shared object copying might seem redundant when the entire project with all its dependencies are built on the same machine. Since AUI Boot allows usage of precompiled binaries, instead of paying extra cost determining whether the dependencies are built locally or externally it just copies them to the build tree regardless of their origin.</p>
<h1>
Install-time shared library resolution<a class="aui-toc-hash" href="#CMAKE_INSTALL" id="CMAKE_INSTALL" style="color: var(--fragment-comment) !important">#</a></h1>
<p><code>cmake --install . --prefix=install_prefix</code> produces a portable project installation in <code>install_prefix</code> directory. This involves copying runtime dependencies (for example, <code>.dll</code>, <code>.so</code>, <code>.dylib</code>) alongside executables in a special way so the executables can actually find their dependencies. CPack and <a class="el" href="md_docs_2Packaging_01Your_01App.html">other deployment methods</a> use <code>cpack --install</code> so the behaviour is common.</p>
<p>In addition to CMake's installation behaviour, targets defined with AUI's <a class="el" href="md_docs_2aui__executable.html">aui_executable</a> and <a class="el" href="md_docs_2aui__module.html">aui_module</a> implement an additional installation behaviour to copy all the required dependencies to installation prefix.</p>
<div class="fragment"><div class="line">-- Installing aui</div>
<div class="line">install_dependencies_for aui/test/aui.boot/Tests/b/repo/aui/build/aui/48af8f8e13e479dbffc65d9a15ab1561/lib/libaui.core.so </div>
<div class="line">aui/test/aui.boot/Tests/b/prefix/zlib/48af8f8e13e479dbffc65d9a15ab1561/lib/libz.so.1</div>
<div class="line">Resolved[1]: aui/test/aui.boot/Tests/b/prefix/zlib/48af8f8e13e479dbffc65d9a15ab1561/lib/libz.so.1</div>
<div class="line">install_dependencies_for aui/test/aui.boot/Tests/b/prefix/zlib/48af8f8e13e479dbffc65d9a15ab1561/lib/libz.so.1  </div>
<div class="line">[Installing aui] -- Installing aui.core</div>
<div class="line">[Installing aui] -- Installing dependencies for aui.core</div>
<div class="line">[Installing aui] -- Installing: aui/test/aui.boot/Tests/b/prefix/aui/48af8f8e13e479dbffc65d9a15ab1561/lib/libz.so.1</div>
<div class="line">[Installing aui] -- Installing: aui/test/aui.boot/Tests/b/prefix/aui/48af8f8e13e479dbffc65d9a15ab1561/lib/libz.so.1.2.11</div>
<div class="line">[Installing aui] -- Installing: aui/test/aui.boot/Tests/b/prefix/aui/48af8f8e13e479dbffc65d9a15ab1561/lib/libaui.core.so</div>
<div class="line">[Installing aui] -- Set non-toolchain portion of runtime path of "aui/test/aui.boot/Tests/b/prefix/aui/48af8f8e13e479dbffc65d9a15ab1561/lib/libaui.core.so" to "$ORIGIN/../lib"</div>
<div class="line">...</div>
</div><!-- fragment --><p>The behavior involves utilizing platform-specific tools to analyze the produced binaries. These tools identify all non-system requirements present in the binaries, mitigating the risk of link-time errors on end-user machines by incorporating these requirements into the installation prefix. If some of the shared libraries was not found during installation, an install-time error is thrown.</p>
<p>This behaviour can be disabled by setting <code>-DAUI_INSTALL_RUNTIME_DEPENDENCIES=OFF</code>.</p>
<h2>
DLL platforms (Windows only)<a class="aui-toc-hash" href="#dll-platforms-(windows-only)" id="dll-platforms-(windows-only)" style="color: var(--fragment-comment) !important">#</a></h2>
<p>On Windows, dlls and exes are copied together to the same directory (<code>bin/</code>). </p><div class="fragment"><div class="line">tree install_prefix/</div>
<div class="line">bin/aui_app.exe</div>
<div class="line">bin/aui.core.dll</div>
<div class="line">bin/aui.views.dll</div>
<div class="line">...</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>On Windows, if <a class="el" href="md_docs_2aui__app.html">aui_app</a> was used to produce an application, it reconfigures the installation to put dlls and exe to installation root directory (common practice). From perspective of a user, extra directory hierarchy is redundant. <div class="fragment"><div class="line">tree install_prefix/</div>
<div class="line">aui_app.exe</div>
<div class="line">aui.core.dll</div>
<div class="line">aui.views.dll</div>
<div class="line">...</div>
</div><!-- fragment --> This behaviour is achieved by setting <code>AUI_INSTALL_RUNTIME_DIR</code> target property to <code>"."</code>. To mitigate this behaviour, simply set the property back to "bin" after <code>aui_app</code> call. <div class="fragment"><div class="line">set_target_properties(your_app PROPERTIES AUI_INSTALL_RUNTIME_DIR "bin")</div>
</div><!-- fragment --></dd></dl>
<h2>
Other platforms (UNIX-like only)<a class="aui-toc-hash" href="#other-platforms-(unix-like-only)" id="other-platforms-(unix-like-only)" style="color: var(--fragment-comment) !important">#</a></h2>
<p><a class="el" href="md_docs_2AUI_01Boot.html">AUI Boot</a> updates RUNPATH/RPATH CMake install variables to follow that convention:</p>
<ul>
<li><b>ld</b> (Linux/Android): <div class="fragment"><div class="line">set(CMAKE_INSTALL_RPATH $ORIGIN/../lib)</div>
<div class="line">set(CMAKE_INSTALL_RPATH_USE_LINK_PATH FALSE)</div>
</div><!-- fragment --></li>
<li><b>dyld</b> (macOS/iOS): <div class="fragment"><div class="line">set(CMAKE_INSTALL_NAME_DIR "@rpath")</div>
<div class="line">set(CMAKE_INSTALL_RPATH "@loader_path/../lib")</div>
</div><!-- fragment --></li>
</ul>
<p>Typical Linux app installation consists of <code>bin/</code> directory where the executables are located and <code>lib/</code> directory for shared libraries (*.so). The <code>lib/</code> directory should contain all shared libraries required by the executable. </p><div class="fragment"><div class="line">tree install_prefix/</div>
<div class="line">bin/aui_app</div>
<div class="line">lib/libaui.core.so</div>
<div class="line">lib/libaui.views.so</div>
<div class="line">...</div>
</div><!-- fragment --><p>Additionally, <code>cmake --install .</code> removes hardcoded absolute library paths from executables that were required for development. </p>
</div><p class="footer-inner">
    © 2025 AUI Framework Contributors. Documentation contributions included herein are the copyrights of their
    respective owners. The documentation provided herein is licensed under the terms of the GNU Free Documentation
    License version 1.3 as published by the Free Software Foundation. All trademarks are property of their respective owners.
</p>
</div><div class="contents-rails-right"><div class="aui-toc"><p>Contents</p><h1><a href="#build-time-shared-library-resolution">Build-time shared library resolution</a></h1><h2><a href="#dll-platforms-(windows-only)">DLL platforms (Windows only)</a></h2><h2><a href="#RPATH">Other platforms (UNIX-like only)</a></h2><h1><a href="#CMAKE_INSTALL">Install-time shared library resolution</a></h1><h2><a href="#dll-platforms-(windows-only)">DLL platforms (Windows only)</a></h2><h2><a href="#other-platforms-(unix-like-only)">Other platforms (UNIX-like only)</a></h2><div class="aui-toc-extras"><a href="javascript:jumpToSource('view')"><i class="fa fa-file"></i>View Page Source</a><a href="javascript:jumpToSource('edit')"><i class="fa fa-edit"></i>Edit Page Source</a></div></div></div></div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
</div></body>
</html>
