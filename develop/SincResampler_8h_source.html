<!-- HTML header for doxygen 1.9.1--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class="dark-mode" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
<meta content="noindex" name="robots"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>
<meta content="Doxygen 1.13.1" name="generator"/>
<meta content="width=device-width, initial-scale=0.8" name="viewport"/>
<title>AUI Framework: aui.audio/src/AUI/Audio/SincResampler.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"/>
<script src="jquery.js" type="text/javascript"></script>
<script src="dynsections.js" type="text/javascript"></script>
<script src="toc.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js" type="text/javascript"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script src="navtreedata.js" type="text/javascript"></script>
<script src="navtree.js" type="text/javascript"></script>
<script src="resize.js" type="text/javascript"></script>
<script src="cookie.js" type="text/javascript"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script src="search/searchdata.js" type="text/javascript"></script>
<script src="search/search.js" type="text/javascript"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellpadding="0" cellspacing="0">
<tbody>
<tr style="height: 56px;">
<td id="projectlogo"><img alt="Logo" src="logo_doxygen.svg"/></td>
<td id="projectalign" style="padding-left: 0.5em;">
<div id="projectname">AUI Framework
                         <span id="projectnumber">develop</span>
</div>
<div id="projectbrief">Cross-platform base for C++ UI apps</div>
</td>
</tr>
</tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script src="menudata.js" type="text/javascript"></script>
<script src="menu.js" type="text/javascript"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('SincResampler_8h_source.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>
<div class="header">
<div class="headertitle"><div class="title">SincResampler.h</div></div>
</div><!--header-->
<div class="contents aui-toc-contents"><div class="contents-rails-left">
<div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2012 The Chromium Authors</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// Use of this source code is governed by a BSD-style license that can be</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// found in the LICENSE file.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span> </div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// NOLINTBEGIN(bugprone-integer-division,bugprone-unhandled-self-assignment,modernize-use-std-numbers)</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span> </div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="preprocessor">#ifndef MEDIA_BASE_SINC_RESAMPLER_H_</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="preprocessor">#define MEDIA_BASE_SINC_RESAMPLER_H_</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span> </div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="preprocessor">#if defined(__i386__) || defined(_M_IX86) || defined(__x86_64__) || defined(_M_X64)</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="preprocessor">#define ARCH_CPU_X86_FAMILY</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#if defined(__AVX2__) &amp;&amp; defined(USE_FMA)</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#define USE_AVX2</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#if defined(__SSE3__) || (defined(_MSC_VER) &amp;&amp; defined(__AVX__))</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#define USE_SSE3</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#if defined(__arm__) || defined(__thumb__) || defined(_M_ARM) || defined(__aarch64__) || defined(_M_ARM64)</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#define ARCH_CPU_ARM_FAMILY</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#if defined(__ARM_NEON) || defined(__ARM_NEON__)</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#define USE_NEON</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span> </div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;memory&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &lt;functional&gt;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="keyword">namespace </span>base {</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Signature&gt;</div>
<div class="foldopen" data-end="};" data-start="{" id="foldopen00035">
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="structbase_1_1RepeatingCallback.html">   35</a></span><span class="keyword">struct </span>RepeatingCallback {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  <span class="keyword">using </span>FnType = std::function&lt;Signature&gt;;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>  FnType fn;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  RepeatingCallback(FnType&amp;&amp; fn_in) : fn(std::move(fn_in)) {}</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>  <span class="keyword">template</span>&lt;<span class="keyword">typename</span>... Args&gt;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  <span class="keyword">decltype</span>(<span class="keyword">auto</span>) Run(Args&amp;&amp;... args)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <span class="keywordflow">return</span> fn(std::forward&lt;Args&gt;(args)...);</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>  }</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>};</div>
</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>}</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="comment">//#include "base/functional/callback.h"</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="comment">//#include "base/gtest_prod_util.h"</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span><span class="preprocessor">#if defined(_MSC_VER)</span></div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="preprocessor">#include &lt;malloc.h&gt;</span>  <span class="comment">// for _aligned_malloc</span></div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span><span class="keyword">namespace </span>base {</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span><span class="keyword">inline</span> <span class="keyword">auto</span> AlignedAlloc(<span class="keywordtype">size_t</span> size, <span class="keywordtype">size_t</span> alignment) -&gt; <span class="keywordtype">void</span>* {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span><span class="preprocessor">#if defined(_MSC_VER)</span></div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  <span class="keywordflow">return</span> _aligned_malloc(size, alignment);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  <span class="keywordtype">void</span>* ptr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  <span class="keywordflow">if</span> (posix_memalign(&amp;ptr, alignment, size) != 0) {</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>    <span class="keywordflow">return</span> <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  }</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <span class="keywordflow">return</span> ptr;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>}</div>
<div class="foldopen" data-end="};" data-start="{" id="foldopen00062">
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno"><a class="line" href="structbase_1_1AlignedFreeDeleter.html">   62</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structbase_1_1AlignedFreeDeleter.html">AlignedFreeDeleter</a> {</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  <span class="keywordtype">void</span> operator()(<span class="keywordtype">void</span>* ptr)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keywordflow">if</span> (ptr) {</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="preprocessor">#if defined(_MSC_VER)</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>      _aligned_free(ptr);</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>      free(ptr);</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    }</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>};</div>
</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>}</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span><span class="comment">//#include "base/memory/aligned_memory.h"</span></div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span><span class="comment">//#include "base/memory/raw_ptr.h"</span></div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span><span class="preprocessor">#include &lt;cstddef&gt;</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span><span class="preprocessor">#include &lt;type_traits&gt;</span></div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno"><a class="line" href="structAllowPtrArithmetic.html">   78</a></span><span class="keyword">struct </span><a class="code hl_struct" href="structAllowPtrArithmetic.html">AllowPtrArithmetic</a> {};</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span> Traits = <span class="keywordtype">void</span>&gt;</div>
<div class="foldopen" data-end="};" data-start="{" id="foldopen00080">
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno"><a class="line" href="classraw__ptr.html">   80</a></span><span class="keyword">class </span>raw_ptr {</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  T* ptr_;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  <span class="keyword">constexpr</span> raw_ptr() noexcept : ptr_(<span class="keyword">nullptr</span>) {}</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  <span class="keyword">constexpr</span> <span class="keyword">explicit</span> raw_ptr(T* ptr) noexcept : ptr_(ptr) {}</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span> </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keyword">constexpr</span> raw_ptr(<span class="keyword">const</span> raw_ptr&amp; other) noexcept : ptr_(other.ptr_) {}</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  <span class="keyword">auto</span> operator=(T* ptr) <span class="keyword">noexcept</span> -&gt; raw_ptr&amp; {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    ptr_ = ptr;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  }</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span> </div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  <span class="keyword">auto</span> operator=(<span class="keyword">const</span> raw_ptr&amp; other) <span class="keyword">noexcept</span> -&gt; raw_ptr&amp; {</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    ptr_ = other.ptr_;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  }</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> get() <span class="keyword">const</span> <span class="keyword">noexcept</span> -&gt; T* { <span class="keywordflow">return</span> ptr_; }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <span class="keyword">constexpr</span> <span class="keyword">operator</span> T*() <span class="keyword">const</span> <span class="keyword">noexcept</span> { <span class="keywordflow">return</span> ptr_; }</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span> </div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> operator*() <span class="keyword">const</span> <span class="keyword">noexcept</span> -&gt; T&amp; { <span class="keywordflow">return</span> *ptr_; }</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span> </div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> operator-&gt;() <span class="keyword">const</span> <span class="keyword">noexcept</span> -&gt; T* { <span class="keywordflow">return</span> ptr_; }</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> operator==(<span class="keyword">const</span> raw_ptr&amp; other) <span class="keyword">const</span> <span class="keyword">noexcept</span> -&gt; <span class="keywordtype">bool</span> { <span class="keywordflow">return</span> ptr_ == other.ptr_; }</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  <span class="keyword">constexpr</span> <span class="keyword">auto</span> operator!=(<span class="keyword">const</span> raw_ptr&amp; other) <span class="keyword">const</span> <span class="keyword">noexcept</span> -&gt; <span class="keywordtype">bool</span> { <span class="keywordflow">return</span> ptr_ != other.ptr_; }</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U = Traits&gt;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> std::enable_if&lt;std::is_same&lt;U, AllowPtrArithmetic&gt;::value, raw_ptr&gt;::type</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>  operator+(std::ptrdiff_t offset) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="keywordflow">return</span> raw_ptr(ptr_ + offset);</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>  }</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span> </div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U = Traits&gt;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> std::enable_if&lt;std::is_same&lt;U, AllowPtrArithmetic&gt;::value, raw_ptr&gt;::type</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  operator-(std::ptrdiff_t offset) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="keywordflow">return</span> raw_ptr(ptr_ - offset);</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  }</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> U = Traits&gt;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  <span class="keyword">constexpr</span> <span class="keyword">typename</span> std::enable_if&lt;std::is_same&lt;U, AllowPtrArithmetic&gt;::value, std::ptrdiff_t&gt;::type</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  operator-(<span class="keyword">const</span> raw_ptr&amp; other) <span class="keyword">const</span> <span class="keyword">noexcept</span> {</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="keywordflow">return</span> ptr_ - other.ptr_;</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  }</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>};</div>
</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span><span class="comment">//#include "build/build_config.h"</span></div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span><span class="comment">//#include "media/base/media_export.h"</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span> </div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span><span class="preprocessor">#define FRIEND_TEST_ALL_PREFIXES(...)</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span><span class="keyword">namespace </span>media {</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span> </div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span><span class="comment">// SincResampler is a high-quality single-channel sample-rate converter.</span></div>
<div class="foldopen" data-end="};" data-start="{" id="foldopen00138">
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno"><a class="line" href="classmedia_1_1SincResampler.html">  138</a></span><span class="keyword">class </span>SincResampler {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span><span class="keyword">public</span>:</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>  <span class="comment">// The kernel size can be adjusted for quality (higher is better) at the</span></div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>  <span class="comment">// expense of performance.  Must be a multiple of 32. We aim for 64 for</span></div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>  <span class="comment">// perceptible audio quality (see crbug.com/1407622), but fallback to 32 in</span></div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  <span class="comment">// cases where `request_frames_` is too small (e.g. 10ms of 8kHz audio).</span></div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  <span class="comment">// Use SincResampler::KernelSize() to check which size is being used.</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kMaxKernelSize = 64;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kMinKernelSize = 32;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span> </div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  <span class="comment">// Default request size.  Affects how often and for how much SincResampler</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="comment">// calls back for input.  Must be greater than 1.5 * `kernel_size_`.</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kDefaultRequestSize = 512;</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <span class="comment">// A smaller request size, which still allows higher quality resampling, by</span></div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>  <span class="comment">// guaranteeing we will use kMaxKernelSize.</span></div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kSmallRequestSize = kMaxKernelSize * 2;</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  <span class="comment">// The kernel offset count is used for interpolation and is the number of</span></div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  <span class="comment">// sub-sample kernel shifts.  Can be adjusted for quality (higher is better)</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <span class="comment">// at the expense of allocating more memory.</span></div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">int</span> kKernelOffsetCount = 32;</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>  <span class="comment">// Callback type for providing more data into the resampler.  Expects |frames|</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>  <span class="comment">// of data to be rendered into |destination|; zero padded if not enough frames</span></div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  <span class="comment">// are available to satisfy the request.</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>  <span class="keyword">using </span>ReadCB = <a class="code hl_struct" href="structbase_1_1RepeatingCallback.html">base::RepeatingCallback</a>&lt;void(<span class="keywordtype">int</span> frames, <span class="keywordtype">float</span>* destination)&gt;;</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span> </div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  <span class="comment">// Returns the kernel size which will be used for a given `request_frames`.</span></div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  <span class="keyword">static</span> <span class="keywordtype">int</span> KernelSizeFromRequestFrames(<span class="keywordtype">int</span> request_frames);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  <span class="comment">// Constructs a SincResampler with the specified |read_cb|, which is used to</span></div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  <span class="comment">// acquire audio data for resampling.  |io_sample_rate_ratio| is the ratio</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>  <span class="comment">// of input / output sample rates.  |request_frames| controls the size in</span></div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  <span class="comment">// frames of the buffer requested by each |read_cb| call.  The value must be</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  <span class="comment">// greater than 1.5*`kernel_size_`.  Specify kDefaultRequestSize if there are</span></div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  <span class="comment">// no request size constraints.</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  SincResampler(<span class="keywordtype">double</span> io_sample_rate_ratio,</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>                <span class="keywordtype">int</span> request_frames,</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>                <span class="keyword">const</span> ReadCB read_cb);</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  SincResampler(<span class="keyword">const</span> SincResampler&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  SincResampler&amp; operator=(<span class="keyword">const</span> SincResampler&amp;) = <span class="keyword">delete</span>;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span> </div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  ~SincResampler();</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span> </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>  <span class="comment">// Resample |frames| of data from |read_cb_| into |destination|.</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <span class="keywordtype">void</span> Resample(<span class="keywordtype">int</span> frames, <span class="keywordtype">float</span>* destination);</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span> </div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>  <span class="comment">// The maximum size in output frames that guarantees Resample() will only make</span></div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="comment">// a single call to |read_cb_| for more data.  Note: If PrimeWithSilence() is</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  <span class="comment">// not called, chunk size will grow after the first two Resample() calls by</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <span class="comment">// `kernel_size_` / (2 * io_sample_rate_ratio).  See the .cc file for details.</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  <span class="keywordtype">int</span> ChunkSize()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> chunk_size_; }</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  <span class="comment">// Returns the max number of frames that could be requested (via multiple</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  <span class="comment">// calls to |read_cb_|) during one Resample(|output_frames_requested|) call.</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>  <span class="keywordtype">int</span> GetMaxInputFramesRequested(<span class="keywordtype">int</span> output_frames_requested) <span class="keyword">const</span>;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span> </div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  <span class="comment">// Guarantees that ChunkSize() will not change between calls by initializing</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>  <span class="comment">// the input buffer with silence.  Note, this will cause the first few samples</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <span class="comment">// of output to be biased towards silence. Must be called again after Flush().</span></div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <span class="keywordtype">void</span> PrimeWithSilence();</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>  <span class="comment">// Flush all buffered data and reset internal indices.  Not thread safe, do</span></div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  <span class="comment">// not call while Resample() is in progress.  Note, if PrimeWithSilence() was</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  <span class="comment">// previously called it must be called again after the Flush().</span></div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <span class="keywordtype">void</span> Flush();</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  <span class="comment">// Update |io_sample_rate_ratio_|.  SetRatio() will cause a reconstruction of</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  <span class="comment">// the kernels used for resampling.  Not thread safe, do not call while</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  <span class="comment">// Resample() is in progress.</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  <span class="keywordtype">void</span> SetRatio(<span class="keywordtype">double</span> io_sample_rate_ratio);</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  <span class="comment">// Return number of input frames consumed by a callback but not yet processed.</span></div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  <span class="comment">// Since input/output ratio can be fractional, so can this value.</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  <span class="comment">// Zero before first call to Resample().</span></div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <span class="keywordtype">double</span> BufferedFrames() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span> </div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>  <span class="comment">// Return the actual kernel size used by the resampler. Should be</span></div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>  <span class="comment">// kMaxKernelSize most of the time, but varies based on `request_frames_`;</span></div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>  <span class="keywordtype">int</span> KernelSize() <span class="keyword">const</span>;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span> </div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  <span class="keywordtype">float</span>* get_kernel_for_testing() { <span class="keywordflow">return</span> kernel_storage_.get(); }</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  <span class="keywordtype">int</span> kernel_storage_size_for_testing() { <span class="keywordflow">return</span> kernel_storage_size_; }</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span><span class="keyword">private</span>:</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  FRIEND_TEST_ALL_PREFIXES(SincResamplerTest, Convolve);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  FRIEND_TEST_ALL_PREFIXES(SincResamplerPerfTest, Convolve_unoptimized_aligned);</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  FRIEND_TEST_ALL_PREFIXES(SincResamplerPerfTest, Convolve_optimized_aligned);</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  FRIEND_TEST_ALL_PREFIXES(SincResamplerPerfTest, Convolve_optimized_unaligned);</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span> </div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  <span class="keywordtype">void</span> InitializeKernel();</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keywordtype">void</span> UpdateRegions(<span class="keywordtype">bool</span> second_load);</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>  <span class="comment">// Compute convolution of |k1| and |k2| over |input_ptr|, resultant sums are</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>  <span class="comment">// linearly interpolated using |kernel_interpolation_factor|.  On x86, the</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  <span class="comment">// underlying implementation is chosen at run time based on SSE support.  On</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>  <span class="comment">// ARM, NEON support is chosen at compile time based on compilation flags.</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>  <span class="keyword">static</span> <span class="keywordtype">float</span> Convolve_C(<span class="keyword">const</span> <span class="keywordtype">int</span> kernel_size,</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>                          <span class="keyword">const</span> <span class="keywordtype">float</span>* input_ptr,</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>                          <span class="keyword">const</span> <span class="keywordtype">float</span>* k1,</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>                          <span class="keyword">const</span> <span class="keywordtype">float</span>* k2,</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>                          <span class="keywordtype">double</span> kernel_interpolation_factor);</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="preprocessor">#if defined(ARCH_CPU_X86_FAMILY)</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="preprocessor">#if defined(USE_SSE3)</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>  <span class="keyword">static</span> <span class="keywordtype">float</span> Convolve_SSE(<span class="keyword">const</span> <span class="keywordtype">int</span> kernel_size,</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>                            <span class="keyword">const</span> <span class="keywordtype">float</span>* input_ptr,</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>                            <span class="keyword">const</span> <span class="keywordtype">float</span>* k1,</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>                            <span class="keyword">const</span> <span class="keywordtype">float</span>* k2,</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>                            <span class="keywordtype">double</span> kernel_interpolation_factor);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment">//#if defined(USE_AVX2)</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  <span class="keyword">static</span> <span class="keywordtype">float</span> Convolve_AVX2(<span class="keyword">const</span> <span class="keywordtype">int</span> kernel_size,</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* input_ptr,</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* k1,</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* k2,</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>                             <span class="keywordtype">double</span> kernel_interpolation_factor);</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="comment">//#endif</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="preprocessor">#elif defined(ARCH_CPU_ARM_FAMILY) &amp;&amp; defined(USE_NEON)</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>  <span class="keyword">static</span> <span class="keywordtype">float</span> Convolve_NEON(<span class="keyword">const</span> <span class="keywordtype">int</span> kernel_size,</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* input_ptr,</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* k1,</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>                             <span class="keyword">const</span> <span class="keywordtype">float</span>* k2,</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>                             <span class="keywordtype">double</span> kernel_interpolation_factor);</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>  <span class="comment">// Selects runtime specific CPU features like SSE.  Must be called before</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>  <span class="comment">// using SincResampler.</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>  <span class="keywordtype">void</span> InitializeCPUSpecificFeatures();</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span> </div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> kernel_size_;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> kernel_storage_size_;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <span class="comment">// The ratio of input / output sample rates.</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  <span class="keywordtype">double</span> io_sample_rate_ratio_;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>  <span class="comment">// An index on the source input buffer with sub-sample precision.  It must be</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>  <span class="comment">// double precision to avoid drift.</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <span class="keywordtype">double</span> virtual_source_idx_;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span> </div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>  <span class="comment">// The buffer is primed once at the very beginning of processing.</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>  <span class="keywordtype">bool</span> buffer_primed_;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span> </div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>  <span class="comment">// Source of data for resampling.</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  <span class="keyword">const</span> ReadCB read_cb_;</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span> </div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>  <span class="comment">// The size (in samples) to request from each |read_cb_| execution.</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> request_frames_;</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  <span class="comment">// The number of source frames processed per pass.</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>  <span class="keywordtype">int</span> block_size_;</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  <span class="comment">// Cached value used for ChunkSize().  The maximum size in frames that</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>  <span class="comment">// guarantees Resample() will only ask for input at most once.</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  <span class="keywordtype">int</span> chunk_size_;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span> </div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>  <span class="comment">// The size (in samples) of the internal buffer used by the resampler.</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> input_buffer_size_;</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span> </div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>  <span class="comment">// Contains kKernelOffsetCount kernels back-to-back, each of size</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>  <span class="comment">// `kernel_size_`. The kernel offsets are sub-sample shifts of a windowed sinc</span></div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>  <span class="comment">// shifted from 0.0 to 1.0 sample.</span></div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>  std::unique_ptr&lt;float[], base::AlignedFreeDeleter&gt; kernel_storage_;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>  std::unique_ptr&lt;float[], base::AlignedFreeDeleter&gt; kernel_pre_sinc_storage_;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  std::unique_ptr&lt;float[], base::AlignedFreeDeleter&gt; kernel_window_storage_;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span> </div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>  <span class="comment">// Data from the source is copied into this buffer for each processing pass.</span></div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>  std::unique_ptr&lt;float[], base::AlignedFreeDeleter&gt; input_buffer_;</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span> </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>  <span class="comment">// Stores the runtime selection of which Convolve function to use.</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>  <span class="keyword">using </span>ConvolveProc =</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      float (*)(<span class="keyword">const</span> int, <span class="keyword">const</span> <span class="keywordtype">float</span>*, <span class="keyword">const</span> <span class="keywordtype">float</span>*, <span class="keyword">const</span> <span class="keywordtype">float</span>*, double);</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  ConvolveProc convolve_proc_;</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span> </div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <span class="comment">// Pointers to the various regions inside |input_buffer_|.  See the diagram at</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  <span class="comment">// the top of the .cc file for more information.</span></div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>  <a class="code hl_class" href="classraw__ptr.html">raw_ptr&lt;float, AllowPtrArithmetic&gt;</a> r0_;</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <span class="keyword">const</span> <a class="code hl_class" href="classraw__ptr.html">raw_ptr&lt;float, AllowPtrArithmetic&gt;</a> r1_;</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  <span class="keyword">const</span> <a class="code hl_class" href="classraw__ptr.html">raw_ptr&lt;float, AllowPtrArithmetic&gt;</a> r2_;</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <a class="code hl_class" href="classraw__ptr.html">raw_ptr&lt;float, AllowPtrArithmetic&gt;</a> r3_;</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  <a class="code hl_class" href="classraw__ptr.html">raw_ptr&lt;float, AllowPtrArithmetic&gt;</a> r4_;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>};</div>
</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>}  <span class="comment">// namespace media</span></div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span><span class="preprocessor">#endif  </span><span class="comment">// MEDIA_BASE_SINC_RESAMPLER_H_</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span><span class="comment">// NOLINTEND(bugprone-integer-division,bugprone-unhandled-self-assignment,modernize-use-std-numbers)</span></div>
<div class="ttc" id="aclassraw__ptr_html"><div class="ttname"><a href="classraw__ptr.html">raw_ptr</a></div><div class="ttdef"><b>Definition</b> SincResampler.h:80</div></div>
<div class="ttc" id="astructAllowPtrArithmetic_html"><div class="ttname"><a href="structAllowPtrArithmetic.html">AllowPtrArithmetic</a></div><div class="ttdef"><b>Definition</b> SincResampler.h:78</div></div>
<div class="ttc" id="astructbase_1_1AlignedFreeDeleter_html"><div class="ttname"><a href="structbase_1_1AlignedFreeDeleter.html">base::AlignedFreeDeleter</a></div><div class="ttdef"><b>Definition</b> SincResampler.h:62</div></div>
<div class="ttc" id="astructbase_1_1RepeatingCallback_html"><div class="ttname"><a href="structbase_1_1RepeatingCallback.html">base::RepeatingCallback</a></div><div class="ttdef"><b>Definition</b> SincResampler.h:35</div></div>
</div><!-- fragment --><p class="footer-inner">
    © 2025 AUI Framework Contributors. Documentation contributions included herein are the copyrights of their
    respective owners. The documentation provided herein is licensed under the terms of the GNU Free Documentation
    License version 1.3 as published by the Free Software Foundation. All trademarks are property of their respective owners.
</p>
</div><div class="contents-rails-right"></div></div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'dark',
        themeVariables: {
            primaryTextColor: '#d2dbde',
            lineColor: '#1982d2',
            tertiaryColor: '#272c34',
        },
    });
</script>
</div></body>
</html>
