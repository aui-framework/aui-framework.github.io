<!-- HTML header for doxygen 1.9.1--><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class="dark-mode" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta content="text/xhtml;charset=utf-8" http-equiv="Content-Type"/>
<meta content="IE=9" http-equiv="X-UA-Compatible"/>
<meta content="Doxygen 1.13.1" name="generator"/>
<meta content="width=device-width, initial-scale=0.8" name="viewport"/>
<title>AUI Framework: APropertyPrecomputed&lt; T &gt; Class Template Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet"/>
<script src="jquery.js" type="text/javascript"></script>
<script src="dynsections.js" type="text/javascript"></script>
<script src="toc.js" type="text/javascript"></script>
<script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js" type="text/javascript"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script src="navtreedata.js" type="text/javascript"></script>
<script src="navtree.js" type="text/javascript"></script>
<script src="resize.js" type="text/javascript"></script>
<script src="cookie.js" type="text/javascript"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script src="search/searchdata.js" type="text/javascript"></script>
<script src="search/search.js" type="text/javascript"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellpadding="0" cellspacing="0">
<tbody>
<tr style="height: 56px;">
<td id="projectlogo"><img alt="Logo" src="logo_doxygen.svg"/></td>
<td id="projectalign" style="padding-left: 0.5em;">
<div id="projectname">AUI Framework
                         <span id="projectnumber">develop</span>
</div>
<div id="projectbrief">Cross-platform base for C++ UI apps</div>
</td>
</tr>
</tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script src="menudata.js" type="text/javascript"></script>
<script src="menu.js" type="text/javascript"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="ui-resizable side-nav-resizable" id="side-nav">
<div id="nav-tree">
<div id="nav-tree-contents">
<div class="sync" id="nav-sync"></div>
</div>
</div>
<div class="ui-resizable-handle" id="splitbar" style="-moz-user-select:none;">
</div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('structAPropertyPrecomputed.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow" onkeydown="return searchBox.OnSearchSelectKey(event)" onmouseout="return searchBox.OnSearchSelectHide()" onmouseover="return searchBox.OnSearchSelectShow()">
</div>
<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>
<div class="header">
<div class="headertitle"><div class="title">APropertyPrecomputed&lt; T &gt; Class Template Reference<span class="mlabels"><span class="mlabel final">final</span></span><div class="ingroups"><a class="el" href="group__core.html">aui::core</a> » <a class="el" href="group__property__system.html">Property System</a></div></div></div>
</div><!--header-->
<div class="contents aui-toc-contents"><div class="contents-rails-left"><b aui-src="aui.core/src/AUI/Common/APropertyPrecomputed.h#L51"></b>
<p>Readonly property that holds a value computed by an expression.  
 <a href="#details">More...</a></p>
<p><code>#include &lt;<a class="el" href="APropertyPrecomputed_8h_source.html">AUI/Common/APropertyPrecomputed.h</a>&gt;</code></p>
<a id="details" name="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;typename T&gt;<br/>
class APropertyPrecomputed&lt; T &gt;</div><dl class="section warning"><dt>Warning</dt><dd>This API is experimental. Experimental APIs are likely to contain bugs, might be changed or removed in the future. </dd></dl>
<dl class="section user"><dt></dt><dd><code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a>&lt;T&gt;</code> is a readonly property similar to <code><a class="el" href="structAProperty.html" title="Basic easy-to-use property implementation containing T.">AProperty</a>&lt;T&gt;</code>. It holds an instance of <code>T</code> as well. Its value is determined by the C++ function specified in its constructor, typically a C++ lambda expression.</dd></dl>
<p>See <a class="el" href="group__property__system.html">property system</a> for usage info.</p>
<p>Despite properties offer <a class="el" href="group__property__system.html#UIDataBindingTest_Label_via_declarative_projection">projection methods</a>, you might want to track and process values of several properties.</p>
<p><code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a>&lt;T&gt;</code> is a readonly property similar to <code><a class="el" href="structAProperty.html" title="Basic easy-to-use property implementation containing T.">AProperty</a>&lt;T&gt;</code>. It holds an instance of <code>T</code> as well. Its value is determined by a <a class="el" href="namespaceaui_1_1react.html">reactive</a> expression specified in <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a>&lt;T&gt;</code>'s constructor, typically a C++ lambda.</p>
<p>It's convenient to access values from another properties inside the expression. The properties accessed during invocation of the expression are tracked behind the scenes so they become dependencies of <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> automatically. If one of the tracked properties fires <code>changed</code> signal, <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> invalidates its <code>T</code>. <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> follows <a class="el" href="structaui_1_1lazy.html">lazy semantics</a> so the expression is re-evaluated and the new result is applied to <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> as soon as the latter is accessed for the next time.</p>
<p>In other words, it allows to specify relationships between different object properties and reactively update <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> value whenever its dependencies change. <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a>&lt;T&gt;</code> is somewhat similar to <a href="https://doc.qt.io/qt-6/bindableproperties.html">Qt Bindable Properties</a>.</p>
<p><code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> is a readonly property, hence you can't update its value with assignment. You can get its value with <code>value()</code> method or implicit conversion <code>operator T()</code> as with other properties.</p>
<p><b aui-src="aui.core/tests/PropertyPrecomputed.cpp#L29"></b></p>
<h1>
Declaration<a class="aui-toc-hash" href="#declaration" id="declaration" style="color: var(--fragment-comment) !important">#</a></h1>
<p><b aui-src="aui.core/tests/PropertyPrecomputed.cpp#L31"></b> Declare a property with custom expression determining it's value as follows: </p><div class="fragment"><div class="line"></div>
<div class="line"><span class="keyword">struct </span>User {</div>
<div class="line">    <a class="code hl_class" href="structAProperty.html">AProperty&lt;AString&gt;</a> name;</div>
<div class="line">    <a class="code hl_class" href="structAProperty.html">AProperty&lt;AString&gt;</a> surname;</div>
<div class="line">    APropertyPrecomputed&lt;AString&gt; fullName = [&amp;] { <span class="keywordflow">return</span> <span class="stringliteral">"{} {}"</span>_format(name, surname); };</div>
<div class="line">};</div>
<div class="line"></div>
<div class="ttc" id="astructAProperty_html"><div class="ttname"><a href="structAProperty.html">AProperty</a></div><div class="ttdoc">Basic easy-to-use property implementation containing T.</div><div class="ttdef"><b>Definition</b> AProperty.h:30</div></div>
</div><!-- fragment --><p>Let's make little observer object for demonstration: </p><div class="fragment"><div class="line"><span class="keyword">class </span>LogObserver : <span class="keyword">public</span> <a class="code hl_class" href="classAObject.html">AObject</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keywordtype">void</span> log(<span class="keyword">const</span> <a class="code hl_class" href="classAString.html">AString</a>&amp; msg) {</div>
<div class="line">        ALogger::info(<span class="stringliteral">"LogObserver"</span>) &lt;&lt; <span class="stringliteral">"Received value: "</span> &lt;&lt; msg;</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="aclassAObject_html"><div class="ttname"><a href="classAObject.html">AObject</a></div><div class="ttdoc">A base object class.</div><div class="ttdef"><b>Definition</b> AObject.h:39</div></div>
<div class="ttc" id="aclassAString_html"><div class="ttname"><a href="classAString.html">AString</a></div><div class="ttdoc">Represents a Unicode character string.</div><div class="ttdef"><b>Definition</b> AString.h:38</div></div>
</div><!-- fragment --><p>Usage: </p><div class="fragment"><div class="line"><span class="keyword">auto</span> u = <a class="code hl_function" href="structaui_1_1ptr.html#a42f8c54fdf7e4c67e32badedcdffe775">aui::ptr::manage_shared</a>(<span class="keyword">new</span> User {</div>
<div class="line">    .name = <span class="stringliteral">"Emma"</span>,</div>
<div class="line">    .surname = <span class="stringliteral">"Watson"</span>,</div>
<div class="line">});</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> observer = _new&lt;LogObserver&gt;();</div>
<div class="line">EXPECT_CALL(*observer, log(<a class="code hl_class" href="classAString.html">AString</a>(<span class="stringliteral">"Emma Watson"</span>))).Times(1);</div>
<div class="line"><a class="code hl_function" href="group__signal__slot.html#ga4da6280feaeb063ce8e5b8a069755d6d">AObject::connect</a>(u-&gt;fullName, <a class="code hl_define" href="group__signal__slot.html#ga17f523dcc2e10d3b91bbf7083ba4bb65">AUI_SLOT</a>(observer)::log);</div>
<div class="ttc" id="agroup__signal__slot_html_ga17f523dcc2e10d3b91bbf7083ba4bb65"><div class="ttname"><a href="group__signal__slot.html#ga17f523dcc2e10d3b91bbf7083ba4bb65">AUI_SLOT</a></div><div class="ttdeci">#define AUI_SLOT(v)</div><div class="ttdoc">Passes some variable and type of the variable separated by comma. It's convenient to use with the con...</div><div class="ttdef"><b>Definition</b> kAUI.h:88</div></div>
<div class="ttc" id="agroup__signal__slot_html_ga4da6280feaeb063ce8e5b8a069755d6d"><div class="ttname"><a href="group__signal__slot.html#ga4da6280feaeb063ce8e5b8a069755d6d">AObject::connect</a></div><div class="ttdeci">static decltype(auto) connect(const Signal &amp;signal, Object *object, Function &amp;&amp;function)</div><div class="ttdoc">Connects signal to the slot of the specified object.</div><div class="ttdef"><b>Definition</b> AObject.h:82</div></div>
<div class="ttc" id="astructaui_1_1ptr_html_a42f8c54fdf7e4c67e32badedcdffe775"><div class="ttname"><a href="structaui_1_1ptr.html#a42f8c54fdf7e4c67e32badedcdffe775">aui::ptr::manage_shared</a></div><div class="ttdeci">static _&lt; T &gt; manage_shared(T *raw)</div><div class="ttdoc">Delegates memory management of the raw pointer T* raw to the shared pointer, which is returned.</div><div class="ttdef"><b>Definition</b> SharedPtrTypes.h:460</div></div>
</div><!-- fragment --><p>The example above prints "Emma Watson". If we try to update one of dependencies of <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> (i.e., <code>name</code> or <code>surname</code>), <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> responds immediately: </p><div class="fragment"><div class="line">EXPECT_CALL(*observer, log(<a class="code hl_class" href="classAString.html">AString</a>(<span class="stringliteral">"Emma Stone"</span>))).Times(1);</div>
<div class="line">u-&gt;surname = <span class="stringliteral">"Stone"</span>;</div>
</div><!-- fragment --><p>The example above prints "Emma Stone".</p>
<h1>
Valid Expressions<a class="aui-toc-hash" href="#PropertyPrecomputedTest_Valid_Expressions" id="PropertyPrecomputedTest_Valid_Expressions" style="color: var(--fragment-comment) !important">#</a></h1>
<p><b aui-src="aui.core/tests/PropertyPrecomputed.cpp#L91"></b> Any C++ callable evaluating to <code>T</code> can be used as an expression for <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a>&lt;T&gt;</code>. However, to formulate correct expression, some rules must be satisfied.</p>
<p>Dependency tracking only works on other properties. It is the developer's responsibility to ensure all values referenced in the expression are properties, or, at least, non-property values that wouldn't change or whose changes are not interesting. You definitely can use branching inside the expression, but you must be confident about what are you doing. Generally speaking, use as trivial expressions as possible.</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>User {</div>
<div class="line">    <a class="code hl_class" href="structAProperty.html">AProperty&lt;AString&gt;</a> name;</div>
<div class="line">    <a class="code hl_class" href="structAProperty.html">AProperty&lt;AString&gt;</a> surname;</div>
<div class="line">    APropertyPrecomputed&lt;AString&gt; fullName = [&amp;]() -&gt; <a class="code hl_class" href="classAString.html">AString</a> {</div>
<div class="line">        <span class="keywordflow">if</span> (name-&gt;empty()) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">"-"</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (surname-&gt;empty()) {</div>
<div class="line">            <span class="keywordflow">return</span> <span class="stringliteral">"-"</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">"{} {}"</span>_format(name, surname);</div>
<div class="line">    };</div>
<div class="line">};</div>
</div><!-- fragment --><p>In this expression, we have a fast path return if <code>name</code> is empty. </p><div class="fragment"><div class="line">User u = {</div>
<div class="line">    .name = <span class="stringliteral">"Emma"</span>,</div>
<div class="line">    .surname = <span class="stringliteral">"Watson"</span>,</div>
<div class="line">};</div>
<div class="line"><span class="comment">// trivial: we've accessed all referenced properties</span></div>
<div class="line">EXPECT_EQ(u.fullName, <span class="stringliteral">"Emma Watson"</span>);</div>
</div><!-- fragment --><p>As soon as we set <code>name</code> to <code>""</code>, we don't access <code>surname</code>. If we try to trigger the fast path return: </p><div class="fragment"><div class="line">u.name = <span class="stringliteral">""</span>;</div>
</div><!-- fragment --><p><code>surname</code> can't trigger re-evaluation anyhow. Re-evaluation can be triggered by <code>name</code> only. So, at the moment, we are interested in <code>name</code> changes only.</p>
<p><code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> might evaluate its expression several times during its lifetime. The developer must make sure that all objects referenced in the expression live longer than <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code>.</p>
<p>The expression should not read from the property it's a binding for, including other referenced APropertyPrecomputes. Otherwise, there's an infinite evaluation loop, and <a class="el" href="classAEvaluationLoopException.html">AEvaluationLoopException</a> is thrown. </p>
<h1>
Copying and moving APropertyPrecomputed<a class="aui-toc-hash" href="#copying-and-moving-apropertyprecomputed" id="copying-and-moving-apropertyprecomputed" style="color: var(--fragment-comment) !important">#</a></h1>
<p><b aui-src="aui.core/tests/PropertyPrecomputed.cpp#L156"></b> </p><dl class="section warning"><dt>Warning</dt><dd>Despite the underlying value and factory callback are both copy constructible and movable, the <b>copy and move constructor are explicitly deleted</b> to avoid potential object lifetime errors created by the lambda capture and prevent non-intuitive behaviour.</dd></dl>
<div class="fragment"><div class="line"><span class="keyword">struct </span>User {</div>
<div class="line">    AProperty&lt;AString&gt; <a class="code hl_variable" href="namespaceaui_1_1app__info.html#a00756a7d7e06374b4519f431521316e7">name</a>;</div>
<div class="line">    AProperty&lt;AString&gt; surname;</div>
<div class="line">    APropertyPrecomputed&lt;AString&gt; fullName = [&amp;] { <span class="keywordflow">return</span> <span class="stringliteral">"{} {}"</span>_format(name, surname); };</div>
<div class="line">};</div>
</div><!-- fragment --><p>If copy construction of <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code> were possible, consider the following code: </p><div class="fragment"><div class="line">User user { .name = <span class="stringliteral">"Hello"</span> };</div>
<div class="line"><span class="keyword">auto</span> copy = user;             <span class="comment">// WON'T COMPILE</span></div>
<div class="line"><span class="keyword">auto</span> moved = std::move(user); <span class="comment">// WON'T COMPILE</span></div>
</div><!-- fragment --><p> <code>copy</code> has copied factory function of <code>user</code>, which refers to fields of <code>user</code>, not to <code>copy</code>'s fields. Copy construction of a class or struct discards default values of all fields - this is the way <code><a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a></code>'s factory function is set to <a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a>. </p>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="examples_27guis_2cells_2src_2Cell_8h-example.html#_a0">examples/7guis/cells/src/Cell.h</a>, <a class="el" href="examples_27guis_2crud_2src_2main_8cpp-example.html#_a1">examples/7guis/crud/src/main.cpp</a>, and <a class="el" href="examples_27guis_2timer_2src_2main_8cpp-example.html#_a8">examples/7guis/timer/src/main.cpp</a>.</dd>
</dl>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="ad3cb3140dd54a41dbec1523bb4034981" name="ad3cb3140dd54a41dbec1523bb4034981"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3cb3140dd54a41dbec1523bb4034981">◆ </a></span>invalidate()</h2>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T&gt; </div>
<table class="mlabels">
<tr>
<td class="mlabels-left">
<table class="memname">
<tr>
<td class="memname">void <a class="el" href="structAPropertyPrecomputed.html">APropertyPrecomputed</a>&lt; T &gt;::invalidate </td>
<td>(</td>
<td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
<td></td>
</tr>
</table>
</td>
<td class="mlabels-right">
<span class="mlabels"><span class="mlabel inline">inline</span><span class="mlabel override">override</span><span class="mlabel virtual">virtual</span></span> </td>
</tr>
</table>
</div><div class="memdoc">
<p>In common, you won't need to use this function. <a class="el" href="structAPropertyPrecomputed.html" title="Readonly property that holds a value computed by an expression.">APropertyPrecomputed</a> is reevaluated automatically as soon as one updates a property expression depends on. </p>
<p>Implements <a class="el" href="structaui_1_1react_1_1DependencyObserver.html">aui::react::DependencyObserver</a>.</p>
</div>
</div>
<p class="footer-inner">
    © 2025 AUI Framework Contributors. Documentation contributions included herein are the copyrights of their
    respective owners. The documentation provided herein is licensed under the terms of the GNU Free Documentation
    License version 1.3 as published by the Free Software Foundation. All trademarks are property of their respective owners.
</p>
</div><div class="contents-rails-right"><div class="aui-toc"><p>Contents</p><h1><a href="#declaration">Declaration</a></h1><h1><a href="#PropertyPrecomputedTest_Valid_Expressions">Valid Expressions</a></h1><h1><a href="#copying-and-moving-apropertyprecomputed">Copying and moving APropertyPrecomputed</a></h1><div class="aui-toc-extras"><a href="javascript:jumpToSource('view')"><i class="fa fa-file"></i>View Page Source</a><a href="javascript:jumpToSource('edit')"><i class="fa fa-edit"></i>Edit Page Source</a></div></div></div></div><!-- doc-content -->
<!-- HTML footer for doxygen 1.12.0-->
<!-- start footer part -->
<script>
    mermaid.initialize({
        startOnLoad: true,
        theme: 'dark',
        themeVariables: {
            primaryTextColor: '#d2dbde',
            lineColor: '#1982d2',
            tertiaryColor: '#272c34',
        },
    });
</script>
</div></body>
</html>
